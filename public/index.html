<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PORTAL OS v8</title>
    <script src="/socket.io/socket.io.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=JetBrains+Mono&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #010103; --sidebar: rgba(10, 10, 15, 0.8); --card: rgba(255, 255, 255, 0.03); 
            --border: rgba(255, 255, 255, 0.08); --text: #f0f0f0; --text-dim: #71717a; 
            --accent: #6366f1; --accent-glow: rgba(99, 102, 241, 0.3); --blur: 20px;
        }
        * { box-sizing: border-box; }
        body { margin: 0; padding: 0; font-family: 'Inter', sans-serif; background-color: var(--bg); color: var(--text); height: 100vh; overflow: hidden; display: flex; 
            background-image: radial-gradient(circle at 0% 0%, rgba(99, 102, 241, 0.1) 0%, transparent 40%), radial-gradient(circle at 100% 100%, rgba(168, 85, 247, 0.1) 0%, transparent 40%);
        }
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--accent); }

        aside { width: 280px; min-width: 280px; background: var(--sidebar); backdrop-filter: blur(var(--blur)); border-right: 1px solid var(--border); display: flex; flex-direction: column; height: 100vh; z-index: 100; }
        .brand { padding: 30px 24px; border-bottom: 1px solid var(--border); }
        .logo { font-size: 1.1rem; font-weight: 800; color: #fff; letter-spacing: -0.02em; display: flex; align-items: center; gap: 10px; }
        .logo::before { content: ''; width: 10px; height: 10px; background: var(--accent); border-radius: 50%; box-shadow: 0 0 15px var(--accent); }

        .nav-container { flex: 1; overflow-y: auto; padding: 10px; cursor: grab; user-select: none; }
        .nav-item { padding: 11px 14px; margin-bottom: 2px; border-radius: 10px; cursor: pointer; color: var(--text-dim); font-size: 0.78rem; font-weight: 600; display: flex; justify-content: space-between; align-items: center; }
        .nav-item:hover { background: rgba(255,255,255,0.04); color: #fff; }
        .nav-item.active { background: rgba(99, 102, 241, 0.15); color: var(--accent); border: 1px solid rgba(99,102,241,0.2); }
        .badge { font-size: 0.6rem; background: rgba(0,0,0,0.5); padding: 2px 6px; border-radius: 5px; }

        main { flex: 1; display: flex; flex-direction: column; height: 100vh; }
        .header { padding: 20px 40px; background: rgba(0,0,0,0.3); backdrop-filter: blur(10px); border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
        .search-wrap { position: relative; width: 350px; }
        .search-input { width: 100%; background: rgba(255,255,255,0.05); border: 1px solid var(--border); padding: 11px 15px 11px 40px; border-radius: 10px; color: #fff; outline: none; }
        .search-input:focus { border-color: var(--accent); box-shadow: 0 0 15px var(--accent-glow); }

        .content-scroll { flex: 1; overflow-y: auto; padding: 40px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 12px; }

        .card { background: var(--card); border: 1px solid var(--border); padding: 18px 12px; border-radius: 12px; text-decoration: none; color: var(--text); display: flex; flex-direction: column; align-items: center; transition: 0.2s; }
        .card:hover { transform: translateY(-4px); border-color: var(--accent); background: rgba(255,255,255,0.08); }
        .card img { width: 32px; height: 32px; margin-bottom: 10px; border-radius: 6px; background: #000; }
        .card-name { font-weight: 700; font-size: 0.8rem; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; width: 100%; text-align: center; }
        .card-url { font-size: 0.6rem; color: var(--text-dim); font-family: 'JetBrains Mono'; }

        .custom-page { background: var(--card); padding: 40px; border-radius: 20px; border: 1px solid var(--border); max-width: 800px; margin: 0 auto; line-height: 1.8; backdrop-filter: blur(10px); }
        .dashboard-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-top: 25px; }
        .stat-box { background: rgba(255,255,255,0.03); padding: 25px; border-radius: 15px; border: 1px solid var(--border); text-align: center; }
        .stat-val { font-size: 2rem; font-weight: 800; color: var(--accent); font-family: 'JetBrains Mono'; }
        .discord-btn { display: inline-block; background: #5865F2; color: white !important; padding: 12px 24px; border-radius: 10px; text-decoration: none; font-weight: bold; margin-top: 20px; }

        @media (max-width: 768px) {
            body { flex-direction: column; }
            aside { width: 100%; min-width: 100%; height: auto; border-right: none; }
            .nav-container { display: flex; overflow-x: auto; height: 60px; }
            .header { padding: 15px; flex-direction: column; }
            .search-wrap { width: 100%; }
        }
    </style>
</head>
<body>
    <aside>
        <div class="brand">
            <div class="logo">PORTAL <span>OS</span></div>
            <div id="stats-nav" style="font-size: 0.65rem; color: var(--accent); margin-top: 5px;">Server Connecting...</div>
        </div>
        <div id="navArea" class="nav-container"></div>
    </aside>
    <main>
        <div class="header">
            <h1 id="pageTitle" style="font-size:1.2rem;">Home</h1>
            <div class="search-wrap">
                <input type="text" id="searchInput" class="search-input" placeholder="Quick Search... (/)">
            </div>
        </div>
        <div id="contentArea" class="content-scroll"></div>
    </main>

    <script>
        /**
         * ==========================================
         *  ‚òÖ CONFIGURATION
         * ==========================================
         */
        const ADMIN_NAME = "ABS Owner";
        const PROF_ICON = "https://vvrl.cc/jp/ga2yu3"; 
        const DISCORD_URL = "https://discord.gg/XQFg36j6";
        const ADMIN_PASS = "ABSSena";

        const EDIT_PAGES = {
            "‚ÑπÔ∏è Info": `<div class="custom-page"><h2>ÊÉÖÂ†±</h2><p>Âé≥ÈÅ∏„Åï„Çå„ÅüÂÆüÂú®„Çµ„Ç§„Éà1200+„ÇíÂèéÈå≤„ÄÇ</p><p>Âà©Áî®„ÅØËá™Â∑±Ë≤¨‰ªª„Åß„Åô„ÄÇ</p><ul><li>Status: Online</li><li>Build: v8.0</li></ul></div>`,
            "üë®‚Äçüíª Creator": `<div class="custom-page" style="text-align:center;"><img src="${PROF_ICON}" style="width:100px;height:100px;border-radius:50%;border:3px solid var(--accent);margin-bottom:15px;object-fit:cover;"><h2>${ADMIN_NAME}</h2><p>Portal Admin</p><a href="${DISCORD_URL}" target="_blank" class="discord-btn">Discord</a></div>`
        };

        const DB_RAW = {
            "üè† Essential": "Google|google.com,YouTube|youtube.com,Facebook|facebook.com,Amazon|amazon.com,X|twitter.com,Instagram|instagram.com,LinkedIn|linkedin.com,Reddit|reddit.com,Wikipedia|wikipedia.org,ChatGPT|chatgpt.com,Netflix|netflix.com,GitHub|github.com,Spotify|spotify.com,Discord|discord.com,Notion|notion.so,Slack|slack.com,Zoom|zoom.us,TikTok|tiktok.com,Dropbox|dropbox.com,Yahoo JP|yahoo.co.jp,Rakuten|rakuten.co.jp,LINE|line.me,Note|note.com,Qiita|qiita.com,Zenn|zenn.dev,DeepL|deepl.com,Mercari|mercari.com,TVer|tver.jp,AbemaTV|abema.tv,Niconico|nicovideo.jp",
            "ü§ñ AI universe": "OpenAI|openai.com,Claude|claude.ai,Perplexity|perplexity.ai,Gemini|gemini.google.com,Mistral AI|mistral.ai,HuggingFace|huggingface.co,Midjourney|midjourney.com,StableDiffusion|stability.ai,Civitai|civitai.com,Leonardo AI|leonardo.ai,RunwayML|runwayml.com,Pika Art|pika.art,Suno AI|suno.com,Udio AI|udio.com,ElevenLabs|elevenlabs.io,HeyGen|heygen.com,Luma AI|lumalabs.ai,Krea AI|krea.ai,Phind|phind.com,v0.dev|v0.dev,Cursor AI|cursor.com,Jasper|jasper.ai,Copy.ai|copy.ai,ChatPDF|chatpdf.com,LangChain|langchain.com",
            "üíª Frontend": "React|react.dev,Next.js|nextjs.org,Vue.js|vuejs.org,Nuxt|nuxt.com,Svelte|svelte.dev,SolidJS|solidjs.com,Angular|angular.io,Astro|astro.build,Remix|remix.run,Tailwind|tailwindcss.com,Bootstrap|getbootstrap.com,MUI|mui.com,Chakra UI|chakra-ui.com,Shadcn UI|ui.shadcn.com,Framer Motion|framer.com,Three.js|threejs.org,Vite|vitejs.dev,Webpack|webpack.js.org,TypeScript|typescriptlang.org,Storybook|storybook.js.org,TanStack|tanstack.com,Zustand|zustand.docs.pmnd.rs,Redux|redux.js.org,Iconify|iconify.design,Can I Use|caniuse.com,GSAP|greensock.com,Vercel|vercel.com,Netlify|netlify.com",
            "‚öôÔ∏è Backend": "Node.js|nodejs.org,Deno|deno.com,Bun|bun.sh,Python|python.org,Go|go.dev,Rust|rust-lang.org,Ruby|ruby-lang.org,PHP|php.net,Java|java.com,Kotlin|kotlinlang.org,Docker|docker.com,Kubernetes|kubernetes.io,Terraform|terraform.io,AWS|aws.amazon.com,Azure|azure.com,Heroku|heroku.com,Supabase|supabase.com,Firebase|firebase.google.com,Appwrite|appwrite.io,MongoDB|mongodb.com,PostgreSQL|postgresql.org,MySQL|mysql.com,Redis|redis.io,PlanetScale|planetscale.com,Neon DB|neon.tech,Elasticsearch|elastic.co,Kafka|kafka.apache.org,Nginx|nginx.org,Strapi|strapi.io,Django|djangoproject.com,FastAPI|fastapi.tiangolo.com,Laravel|laravel.com",
            "üé® Design": "Figma|figma.com,Canva|canva.com,Adobe CC|adobe.com,Sketch|sketch.com,Affinity|affinity.serif.com,Dribbble|dribbble.com,Behance|behance.net,Pinterest|pinterest.com,ArtStation|artstation.com,Unsplash|unsplash.com,Pexels|pexels.com,Pixabay|pixabay.com,Shutterstock|shutterstock.com,Freepik|freepik.com,Vecteezy|vecteezy.com,Coolors|coolors.co,Color Hunt|colorhunt.co,Adobe Color|color.adobe.com,Miro|miro.com,Lucidchart|lucidchart.com,Spline|spline.design,Blender|blender.org,LottieFiles|lottiefiles.com,Photopea|photopea.com,RemoveBG|remove.bg,InVision|invisionapp.com",
            "üîí Security": "HaveIBeenPwned|haveibeenpwned.com,VirusTotal|virustotal.com,UrlScan|urlscan.io,Shodan|shodan.io,Censys|censys.io,BinaryEdge|binaryedge.io,GreyNoise|greynoise.io,Exploit-DB|exploit-db.com,CVE Details|cvedetails.com,NVD|nvd.nist.gov,OWASP|owasp.org,HackTheBox|hackthebox.com,TryHackMe|tryhackme.com,ProtonVPN|protonvpn.com,NordVPN|nordvpn.com,Tor Project|torproject.org,Kali Linux|kali.org,Wireshark|wireshark.org,Metasploit|metasploit.com,Burp Suite|portswigger.net,OSINT Framework|osintframework.com,Intelligence X|intelx.io,Who.is|who.is,Wappalyzer|wappalyzer.com",
            "üí∞ Finance": "TradingView|tradingview.com,Yahoo Finance|finance.yahoo.com,Bloomberg|bloomberg.com,Reuters|reuters.com,Nikkei|nikkei.com,MarketWatch|marketwatch.com,CoinMarketCap|coinmarketcap.com,CoinGecko|coingecko.com,DefiLlama|defillama.com,Dune|dune.com,Etherscan|etherscan.io,Binance|binance.com,Coinbase|coinbase.com,Kraken|kraken.com,Bybit|bybit.com,OKX|okx.com,MetaMask|metamask.io,Phantom|phantom.app,OpenSea|opensea.io,PayPal|paypal.com,Stripe|stripe.com,Wise|wise.com,SBI Bank|netbk.co.jp,‰∏âËè±UFJ|mufg.jp,‰∏â‰∫ï‰ΩèÂèã|smbc.co.jp",
            "üìö Academic": "Wikipedia|wikipedia.org,Britannica|britannica.com,Google Scholar|scholar.google.com,ResearchGate|researchgate.net,arXiv|arxiv.org,PubMed|pubmed.ncbi.nlm.nih.gov,JSTOR|jstor.org,Sci-Hub|sci-hub.se,LibGen|libgen.is,Gutenberg|gutenberg.org,Internet Archive|archive.org,Statista|statista.com,TED JP|ted.com,Udemy|udemy.com,Coursera|coursera.org,edX|edx.org,Khan Academy|khanacademy.org,Skillshare|skillshare.com,Duolingo|duolingo.com,Progate|prog-8.com,LeetCode|leetcode.com,freeCodeCamp|freecodecamp.org,MIT|mit.edu,Stanford|stanford.edu,Harvard|harvard.edu,UTokyo|u-tokyo.ac.jp",
            "üì∫ Media": "Netflix|netflix.com,Prime Video|primevideo.com,Disney+|disneyplus.com,Hulu|hulu.com,U-NEXT|video.unext.jp,Abema|abema.tv,TVer|tver.jp,YouTube|youtube.com,Niconico|nicovideo.jp,Bilibili|bilibili.com,Spotify|spotify.com,Apple Music|music.apple.com,Crunchyroll|crunchyroll.com,MyAnimeList|myanimelist.net,IMDb|imdb.com,Letterboxd|letterboxd.com,Vimeo|vimeo.com,DailyMotion|dailymotion.com,Kindle|amazon.com/kindle,Audible|audible.com,TechCrunch|techcrunch.com,The Verge|theverge.com,Wired|wired.com,Gizmodo|gizmodo.com",
            "üõí Shopping": "Amazon|amazon.com,Amazon JP|amazon.co.jp,Rakuten|rakuten.co.jp,Yahoo Shop|shopping.yahoo.co.jp,AliExpress|aliexpress.com,Temu|temu.com,eBay|ebay.com,Etsy|etsy.com,Qoo10|qoo10.jp,iHerb|iherb.com,Uniqlo|uniqlo.com,GU|gu-global.com,ZARA|zara.com,H&M|hm.com,ABC-Mart|abc-mart.net,Mercari|mercari.com,Daiso|daiso-sangyo.co.jp,Nitori|nitori-net.jp,IKEA|ikea.com,Muji|muji.com,Uber Eats|ubereats.com,Demae-can|demae-can.com,McDonald's|mcdonalds.co.jp,Starbucks|starbucks.co.jp",
            "‚úàÔ∏è Travel": "Google Maps|maps.google.com,Earth|earth.google.com,FlightRadar24|flightradar24.com,MarineTraffic|marinetraffic.com,Windy|windy.com,Booking.com|booking.com,Agoda|agoda.com,Expedia|expedia.com,Airbnb|airbnb.com,TripAdvisor|tripadvisor.com,Skyscanner|skyscanner.net,Kayak|kayak.com,Jalan|jalan.net,Rakuten Travel|travel.rakuten.co.jp,Ikyu|ikyu.com,Uber|uber.com,Grab|grab.com,Waze|waze.com,Tenki.jp|tenki.jp,Suumo|suumo.jp,Homes.jp|homes.co.jp,Hostelworld|hostelworld.com",
            "üõ† Utils": "Convertio|convertio.co,I Love PDF|ilovepdf.com,Speedtest|speedtest.net,VirusTotal|virustotal.com,Bitly|bitly.com,QR Code Gen|qr-code-generator.com,JSON Formatter|jsonformatter.org,Regex101|regex101.com,CyberChef|gchq.github.io/CyberChef,Smallpdf|smallpdf.com,PDF Candy|pdfcandy.com,Remove.bg|remove.bg,Evernote|evernote.com,Simplenote|simplenote.com,Joplin|joplinapp.org,Obsidian|obsidian.md,Pocket|getpocket.com,Raindrop|raindrop.io,Feedly|feedly.com,WolframAlpha|wolframalpha.com,Bitwarden|bitwarden.com,1Password|1password.com,Temp Mail|temp-mail.org",
            "üîû 18+ (R18)": "Pornhub|pornhub.com,Xvideos|xvideos.com,Xhamster|xhamster.com,Redtube|redtube.com,Xroll|xroll.net,MissAV|missav.ai,Jable|jable.tv,TKTube|tktube.com,Xfree|xfree.com,AstalaVR|astalavr.com,ThisAV|thisav.me,Monsnode|monsnode.com,SpankBang|jp.spankbang.com,Tube8|jp.tube8.com,SEXVID|sexvid.xxx,Javbangers|javbangers.com,TokyoMotion|tokyomotion.net,Twidouga|twidouga.net,EPORNER|eporner.com,ANIPORN|aniporn.com,Rule34 Video|rule34video.com,CrazyShit|crazyshit.com,ChameleonClip|chameleonclip.com,FC2 Adult|video.fc2.com,UraAgesage|asg.to,SexCelebrity|sexcelebrity.net,DeepFakePorn|deepfakeporn.net,Pixiv R18|pixiv.net,DMM R18|dmm.co.jp,Caribbeancom|caribbeancom.com,Heyzo|heyzo.com,1pondo|1pondo.tv,Pacopacomama|pacopacomama.com,Adult.com|adult.com,Reality Kings|realitykings.com,BangBros|bangbros.com,Motherless|motherless.com,Heavy-R|heavy-r.com,Thumbzilla|thumbzilla.com,PornTrex|porntrex.com,DaftSex|daftsex.com,JavThe|javthe.com,JavMost|javmost.com,Hanime|hanime.tv,nHentai|nhentai.net,Hitomi.la|hitomi.la,DLsite|dlsite.com,AVGLE|avgle.com,Simpcity|simpcity.su,Luscious|luscious.net,Gelbooru|gelbooru.com,Danbooru|danbooru.donmai.us,Konachan|konachan.com,Yande.re|yande.re,E-Hentai|e-hentai.org,ExHentai|exhentai.org,Tsumino|tsumino.com,Rule34.paheal|rule34.paheal.net,Cumlouder|cumlouder.com,Vjav|vjav.com,Auporn|auporn.com,Netporn|netporn.com,Hentaigasm|hentaigasm.com,Hentaihaven|hentaihaven.red,3D Hentai|3dhentai.net,Tube8|tube8.com,YouJizz|youjizz.com,PornMD|pornmd.com,TNAFlix|tnaflix.com,SpankWire|spankwire.com,YouJizz|youjizz.com,Porn300|porn300.com,Bunkr|bunkr.is,Cyberdrop|cyberdrop.me,Fapello|fapello.com,Thothub|thothub.to,Skeet|skeet.com,EroMe|erome.com,JavLibrary|javlibrary.com,JavBus|javbus.com,JavGuru|jav.guru,Supjav|supjav.com,JavTiful|javtiful.com,Javcl|javcl.com,BestJavPorn|bestjavporn.com,JavMix|javmix.tv,JavSub|javsub.co,JavPorn|javporn.tv,JavPro|jav.pro,JavPapy|javpapy.com,JavHD|javhd.com,JavLand|javland.com,JavSeen|javseen.tv,JavFree|javfree.me,JavHentai|javhentai.net,JavDatabase|javdatabase.com,HentaiRead|hentairead.com,HentaiFox|hentaifox.com,HentaiForce|hentaiforce.net,HentaiNexus|hentainexus.com,Pururin|pururin.to,HentaiStream|hentaistream.moe,Ohentai|ohentai.org,HentaiMama|hentaimama.io,HentaiPlay|hentaiplay.net,Doujins|doujins.com,MangaDex R18|mangadex.org,Iwara|iwara.tv,Ecchiiwara|ecchi.iwara.tv,Reddit NSFW|reddit.com/nsfw,Chaturbate|chaturbate.com,MyFreeCams|myfreecams.com,Stripchat|stripchat.com,FetLife|fetlife.com,Tinder NSFW|tinder.com,Bumble NSFW|bumble.com,Grindr NSFW|grindr.com,Scruff NSFW|scruff.com,Jackd NSFW|jackd.com,Feeld NSFW|feeld.co,Pure App|pure.app,Hinge NSFW|hinge.co,Omiai|fb.omiai-jp.com,Pairs|pairs.lv,Tapple|tapple.me,With|with.is,Dine|dine.com,ZexyEnmusubi|zexy-enmusubi.net,10musume|10musume.com,H4610|h4610.com,C0930|c0930.com,Kin8tengoku|kin8tengoku.com,G-Area|g-area.org,DrTuber|drtuber.com,Upornia|upornia.com,4tube|4tube.com,PornRabbit|pornrabbit.com,Onetize|onetize.com,Txvideos|txvideos.com,Xfap|xfap.com,Sxyprn|sxyprn.com,Fullporner|fullporner.com,UpperCut|uppercut.com,PornStar|pornstar.com,AVN|avn.com,XBIZ|xbiz.com,FreeOnes|freeones.com,AdultDVD|adultdvdempire.com,HotMovies|hotmovies.com,Sugar|sugar.com,AdultFriendFinder|adultfriendfinder.com,AshleyMadison|ashleymadison.com,Fling|fling.com,BeNaughty|benaughty.com,Hookup|hookup.com,QuickFlirt|quickflirt.com",
            "üåé Global Archive": "NASA|nasa.gov,UN|un.org,UNESCO|unesco.org,WHO|who.int,CIA|cia.gov,FBI|fbi.gov,White House|whitehouse.gov,Gov JP|e-gov.go.jp,MEXT JP|mext.go.jp,METI JP|meti.go.jp,MLIT JP|mlit.go.jp,MIC JP|soumu.go.jp,MOF JP|mof.go.jp,MHLW JP|mhlw.go.jp,MAFF JP|maff.go.jp,MOE JP|env.go.jp,MOD JP|mod.go.jp,NPA JP|npa.go.jp,FSA JP|fsa.go.jp,CAA JP|caa.go.jp,PPC JP|ppc.go.jp,Japan Post|japanpost.jp,JR East|jreast.co.jp,JR West|westjr.co.jp,Tokyo Metro|tokyometro.jp,ANA|ana.co.jp,JAL|jal.co.jp,Skymark|skymark.co.jp,Peach|flypeach.com,JAXA|jaxa.jp,RIKEN|riken.jp,AIST|aist.go.jp,NIMS|nims.go.jp,NICT|nict.go.jp,JAMSTEC|jamstec.go.jp,JST|jst.go.jp,AMED|amed.go.jp,JSPS|jsps.go.jp,NEDO|nedo.go.jp,IPA|ipa.go.jp,JETRO|jetro.go.jp,JICA|jica.go.jp,Diet Library|ndl.go.jp,Kahaku|kahaku.go.jp,TNM|tnm.jp,MOMAT|momat.go.jp,Minpaku|minpaku.ac.jp,Rekihaku|rekihaku.ac.jp,NII|nii.ac.jp,NAO|nao.ac.jp,QST|qst.go.jp,NCC|ncc.go.jp,NCGM|ncgm.go.jp,JMA|jma.go.jp,Kaiho|kaiho.mlit.go.jp,FDMA|fdma.go.jp,GSI|gsi.go.jp,JPO|jpo.go.jp,JFTC|jftc.go.jp,DBJ|dbj.jp,JBIC|jbic.go.jp,JFC|jfc.go.jp,Nochubank|nochubank.or.jp,JA Zenchu|ja-zenchu.or.jp,Zen-Noh|zennoh.or.jp,SBI Asset|sbiam.co.jp,Rakuten Asset|rakuten-am.co.jp,BlackRock JP|blackrock.com/jp,Vanguard JP|vanguard.co.jp,Fidelity JP|fidelity.co.jp,Amundi JP|amundi.co.jp,Pictet JP|pictet.co.jp,Baillie Gifford|bailliegifford.com,Citadel|citadel.com,Millennium|mlp.com,Bridgewater|bridgewater.com,Two Sigma|twosigma.com,Point72|point72.com,AQR|aqr.com,KKR|kkr.com,Blackstone|blackstone.com,Carlyle|carlyle.com,Apollo|apollo.com,TPG|tpg.com,Bain Capital|baincapital.com,CVC|cvc.com,EQT|eqtgroup.com,Permira|permira.com,Advent|adventinternational.com,GIC|gic.com.sg,Temasek|temasek.com.sg,CPP|cppinvestments.com,NBIM|nbim.no,KIC|kic.go.kr,NPS|nps.or.kr,CIC|china-inv.cn,Mubadala|mubadala.com,PIF|pif.gov.sa,ADIA|adia.ae,QIA|qia.qa,AfDB|afdb.org,ADB|adb.org,AIIB|aiib.org,EIB|eib.org,EBRD|ebrd.com,IDB|iadb.org,IsDB|isdb.org,IFAD|ifad.org,UNU|unu.edu,UNEP|unep.org,UNICEF JP|unicef.or.jp,UNESCO JP|unesco.or.jp,WHO JP|who.int/japan,UNDP JP|jp.undp.org,WFP JP|ja.wfp.org,UNHCR JP|unhcr.org/jp,IOM JP|japan.iom.int,UNIDO JP|unido.or.jp,IAS|ias.unu.edu,IIGH|iigh.unu.edu,WIDER|wider.unu.edu,FLORES|flores.unu.edu,CRIS|cris.unu.edu,INWEH|inweh.unu.edu,EGOV|egov.unu.edu,EHS|ehs.unu.edu,MERIT|merit.unu.edu,INRA|inra.unu.edu,BIOLAC|biolac.unu.edu,GCM|gcm.unu.edu,CPR|cpr.unu.edu"
        };

        // --- Áä∂ÊÖãÁÆ°ÁêÜ ---
        const SPECIAL_TABS = ["‚öôÔ∏è Settings", "‚ÑπÔ∏è Info", "üë®‚Äçüíª Creator"];
        let allCategories = [];
        let currentIdx = 0;
        let isAdmin = false;
        let sessionStart = Date.now();
        let serverStats = { activeUsers: 0, totalVisits: 0, totalClicks: 0 };
        let socket = null;

        // --- „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Ëµ∑Âãï ---
        function init() {
            try {
                // 1. Socket.ioÊé•Á∂öÔºà„Çµ„Éº„Éê„ÉºÂÅ¥„Åå„Å™„Åè„Å¶„ÇÇ„ÇØ„É©„ÉÉ„Ç∑„É•„Åó„Å™„ÅÑ„Çà„ÅÜ‰øùË≠∑Ôºâ
                if (typeof io !== 'undefined') {
                    socket = io();
                    socket.on('statsUpdate', (data) => {
                        serverStats = data;
                        const el = document.getElementById('stats-nav');
                        if (el) el.textContent = `Active Users: ${data.activeUsers}`;
                        updateDashboard();
                    });
                }

                // 2. „Éá„Éº„Çø„Éô„Éº„Çπ„ÅÆÂ±ïÈñã
                for (const [key, val] of Object.entries(DB_RAW)) {
                    const links = val.split(',').map(s => {
                        const parts = s.split('|').map(x => x.trim());
                        if (parts.length < 2) return null;
                        return { name: parts[0], url: `https://${parts[1]}` };
                    }).filter(x => x !== null);
                    allCategories.push({ type: 'link', name: key, items: links });
                }
                SPECIAL_TABS.forEach(t => allCategories.push({ type: 'special', name: t }));

                const total = allCategories.reduce((acc, c) => acc + (c.items ? c.items.length : 0), 0);
                document.getElementById('stats-nav').textContent = `Total: ${total} Verified Links`;

                renderNav();
                renderContent(0);
                enableDragging();
            } catch (e) {
                console.error("Init Error:", e);
            }
        }

        function renderNav() {
            const nav = document.getElementById('navArea'); nav.innerHTML = '';
            allCategories.forEach((cat, idx) => {
                const d = document.createElement('div');
                d.className = `nav-item ${idx === 0 ? 'active' : ''}`;
                const badge = cat.items ? `<span class="badge">${cat.items.length}</span>` : '';
                d.innerHTML = `<span>${cat.name}</span>${badge}`;
                d.onclick = () => {
                    document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
                    d.classList.add('active'); currentIdx = idx; renderContent(idx);
                };
                nav.appendChild(d);
            });
        }

        function renderContent(idx) {
            const data = allCategories[idx];
            const area = document.getElementById('contentArea');
            const search = document.querySelector('.search-wrap');
            document.getElementById('pageTitle').textContent = data.name;
            area.innerHTML = ''; area.scrollTop = 0;

            if (data.type === 'special') {
                search.style.visibility = 'hidden';
                if (data.name.includes('Settings')) {
                    renderSettings(area);
                } else { 
                    const total = allCategories.reduce((acc, c) => acc + (c.items ? c.items.length : 0), 0);
                    area.innerHTML = EDIT_PAGES[data.name].replace('info-count">-', `info-count">${total}`); 
                }
            } else {
                search.style.visibility = 'visible';
                const grid = document.createElement('div');
                grid.className = 'grid'; grid.id = 'linkGrid';
                const frag = document.createDocumentFragment();
                data.items.forEach(i => frag.appendChild(createCard(i)));
                grid.appendChild(frag); area.appendChild(grid);
            }
        }

        function renderSettings(container) {
            if (isAdmin) {
                const duration = Math.floor((Date.now() - sessionStart) / 1000);
                container.innerHTML = `
                <div class="custom-page">
                    <h2>Admin Dashboard</h2>
                    <div class="dashboard-grid">
                        <div class="stat-box"><div class="stat-label">Realtime</div><div class="stat-val" id="live-count">${serverStats.activeUsers}</div></div>
                        <div class="stat-box"><div class="stat-label">Visits</div><div class="stat-val" id="total-visits">${serverStats.totalVisits}</div></div>
                        <div class="stat-box"><div class="stat-label">Clicks</div><div class="stat-val" id="total-clicks">${serverStats.totalClicks}</div></div>
                        <div class="stat-box"><div class="stat-label">Session</div><div class="stat-val">${Math.floor(duration/60)}m ${duration%60}s</div></div>
                    </div>
                    <button class="discord-btn" style="background:#333; width:100%;" onclick="isAdmin=false; renderContent(currentIdx);">Logout</button>
                </div>`;
            } else {
                container.innerHTML = `
                <div class="custom-page">
                    <h2>Admin Login</h2>
                    <input type="password" id="adminPass" style="width:100%; padding:10px; border-radius:5px; border:1px solid var(--border); background:#000; color:#fff; margin-bottom:10px;" placeholder="Password">
                    <button class="discord-btn" style="width:100%;" onclick="checkAdmin()">Login</button>
                    <hr style="border:0; border-top:1px solid var(--border); margin:30px 0;">
                    <h2>UI Settings</h2>
                    <p>Accent Color:</p>
                    <div style="display:flex;gap:15px;margin-top:10px;">
                        ${['#6366f1','#ec4899','#10b981','#f59e0b','#ef4444'].map(c => `<div style="width:35px;height:35px;background:${c};border-radius:50%;cursor:pointer;border:2px solid #fff;" onclick="setColor('${c}')"></div>`).join('')}
                    </div>
                </div>`;
            }
        }

        function checkAdmin() {
            if (document.getElementById('adminPass').value === ADMIN_PASS) { isAdmin = true; renderContent(currentIdx); }
            else alert("Wrong Password");
        }

        function updateDashboard() {
            const l = document.getElementById('live-count'), v = document.getElementById('total-visits'), c = document.getElementById('total-clicks');
            if(l) l.textContent = serverStats.activeUsers;
            if(v) v.textContent = serverStats.totalVisits.toLocaleString();
            if(c) c.textContent = serverStats.totalClicks.toLocaleString();
        }

        function createCard(i) {
            const domain = new URL(i.url).hostname;
            const a = document.createElement('a'); a.className = 'card'; a.href = i.url; a.target = '_blank';
            a.onclick = () => { if(socket) socket.emit('linkClicked'); };
            a.innerHTML = `<img src="https://www.google.com/s2/favicons?sz=64&domain=${domain}" loading="lazy" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0iIzIyMiI+PGNpcmNsZSBjeD0iMTIiIGN5PSIxMiIgcj0iMTAiLz48L3N2Zz4='">
            <div class="card-name">${i.name}</div><div class="card-url">${domain}</div>`;
            return a;
        }

        function setColor(c) { document.documentElement.style.setProperty('--accent', c); document.documentElement.style.setProperty('--accent-glow', c + '44'); }

        function enableDragging() {
            const nav = document.getElementById('navArea'); let isDown = false, startY, scrollT;
            nav.addEventListener('mousedown', e => { isDown = true; startY = e.pageY - nav.offsetTop; scrollT = nav.scrollTop; });
            nav.addEventListener('mouseleave', () => isDown = false); nav.addEventListener('mouseup', () => isDown = false);
            nav.addEventListener('mousemove', e => { if (!isDown) return; e.preventDefault(); const y = e.pageY - nav.offsetTop; nav.scrollTop = scrollT - (y - startY) * 1.5; });
        }

        document.getElementById('searchInput').addEventListener('input', e => {
            const v = e.target.value.toLowerCase(), data = allCategories[currentIdx];
            if (!data || data.type !== 'link') return;
            const grid = document.getElementById('linkGrid'); grid.innerHTML = '';
            const frag = document.createDocumentFragment();
            data.items.filter(i => i.name.toLowerCase().includes(v) || i.url.toLowerCase().includes(v)).forEach(i => frag.appendChild(createCard(i)));
            grid.appendChild(frag);
        });

        window.onkeydown = e => { if (e.key === '/') { e.preventDefault(); document.getElementById('searchInput').focus(); } };
        init();
    </script>
</body>
</html>
